
CREATE TABLE comuna (
    id_comuna             NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    nombre_comuna         VARCHAR2(30) NOT NULL
);
ALTER TABLE comuna ADD CONSTRAINT comuna_pk PRIMARY KEY ( id_comuna );

CREATE TABLE municipio (
    id_muni                    NUMBER GENERATED by default on null as IDENTITY,
    nombre_muni                VARCHAR2(10) NOT NULL,
    comuna_id                  NUMBER NOT NULL
);

ALTER TABLE municipio ADD CONSTRAINT municipio_pk PRIMARY KEY ( id_muni );

CREATE TABLE ESCUELA (
    id_escuela            NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    nombre_escuela        VARCHAR2(100) NOT NULL,
    cupos_totales         NUMBER NOT NULL,
    descripcion           VARCHAR2(1000) NOT NULL,
    municipio_id          NUMBER NOT NULL,
    imagen                VARCHAR2(100)     
);


ALTER TABLE ESCUELA ADD CONSTRAINT escuela_pk PRIMARY KEY ( id_escuela );

CREATE TABLE curso (
    id_curso         	NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    nomcurso         	VARCHAR2(20) NOT NULL,
    escuela_id        	NUMBER NOT NULL
);


ALTER TABLE curso ADD CONSTRAINT curso_pk PRIMARY KEY ( id_curso );


CREATE TABLE pfs (
    id_pfs               NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    Psicopedagogia       NUMBER(1) NOT NULL,
    Terapeutaocupacional NUMBER(1) NOT NULL,
    Pediatra             NUMBER(1) NOT NULL,
    Fonoaudiologa        NUMBER(1) NOT NULL,
    Ed_diferencial       NUMBER(1) NOT NULL,
    escuela_id           NUMBER NOT NULL
);



ALTER TABLE pfs ADD CONSTRAINT pfs_pk PRIMARY KEY ( id_pfs );

CREATE TABLE persona (
    id_persona                   NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    nombres                      VARCHAR2(50) NOT NULL,
    apellidos	                 VARCHAR2(50) NOT NULL,
    correo_electronico           VARCHAR2(50) NOT NULL,
    Tipo_profesion               NUMBER(1) NOT NULL
    

    

);


ALTER TABLE persona ADD CONSTRAINT persona_pk PRIMARY KEY ( id_persona );

CREATE TABLE usuario (
    id_usuario          NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    nombre_usuario      VARCHAR2(20) NOT NULL,
    clave_usuario       VARCHAR2(20) NOT NULL,
    persona_id          NUMBER NOT NULL,
    rol_usuario         NUMBER NOT NULL
);



ALTER TABLE usuario ADD CONSTRAINT usuario_pk PRIMARY KEY ( id_usuario );

CREATE TABLE rol (
    id_rol              NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    rol            	    VARCHAR2(100)
);


ALTER TABLE rol ADD CONSTRAINT rol_pk PRIMARY KEY ( id_rol );


CREATE TABLE cupoextra (
    id_cupoextra                NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    peticion_cupo               VARCHAR2(500) NOT NULL,
    encargado_peticion          VARCHAR2(100) NOT NULL,
    justificacion_cupo          VARCHAR2(200) NOT NULL,
    Usuario_id                  NUMBER NOT NULL
);



ALTER TABLE cupoextra ADD CONSTRAINT cupoextra_pk PRIMARY KEY ( id_cupoextra );

CREATE TABLE apoderado (
    id_apoderado       NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    nombre_apoderado   VARCHAR2(50) NOT NULL,
    apellido_apoderado VARCHAR2(50) NOT NULL,
    celular            NUMBER(9) NOT NULL
);

ALTER TABLE apoderado ADD CONSTRAINT apoderado_pk PRIMARY KEY ( id_apoderado );

CREATE TABLE alumno (
    id_alumno              NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    nombres_alumno         VARCHAR2(100) NOT NULL,
    apellidos_alumno       VARCHAR2(100) NOT NULL,
    edad                   NUMBER NOT NULL,
    curso_id         NUMBER NOT NULL,
    apoderado_id           NUMBER NOT NULL
);



ALTER TABLE alumno ADD CONSTRAINT alumno_pk PRIMARY KEY ( id_alumno );


CREATE TABLE evaluacion (
    id_diagnostico         NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    archivos_diagnostico    VARCHAR2(500) NOT NULL,
    evaluacion_especialista VARCHAR2(500) NOT NULL
);



ALTER TABLE evaluacion ADD CONSTRAINT evaluacion_pk PRIMARY KEY ( id_diagnostico );


CREATE TABLE alumnopie (
    id_alumnopie              NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    justificativo_ingreso     VARCHAR2(500) NOT NULL,
    alumno_id                 NUMBER NOT NULL,
    fecha_ingreso             DATE NOT NULL,
    evaluacion_id             NUMBER NOT NULL,
    usuario_id                NUMBER NOT NULL
);





ALTER TABLE alumnopie ADD CONSTRAINT alumnopie_pk PRIMARY KEY ( id_alumnopie );


ALTER TABLE municipio
    ADD CONSTRAINT municipio_comuna_fk FOREIGN KEY ( comuna_id)
        REFERENCES comuna ( id_comuna );

ALTER TABLE escuela
    ADD CONSTRAINT escuela_municipio_fk FOREIGN KEY ( municipio_id )
        REFERENCES municipio ( id_muni );

ALTER TABLE curso
    ADD CONSTRAINT curso_escuela_fk FOREIGN KEY ( escuela_id )
        REFERENCES escuela ( id_escuela );

ALTER TABLE pfs
    ADD CONSTRAINT pfs_escuela_fk FOREIGN KEY ( ESCUELA_ID )
        REFERENCES escuela ( id_escuela );

ALTER TABLE cupoextra
    ADD CONSTRAINT cupo_usuario_fk FOREIGN KEY ( usuario_id)
        REFERENCES usuario( id_usuario);


ALTER TABLE usuario
    ADD CONSTRAINT usuario_persona_fk FOREIGN KEY ( persona_id )
        REFERENCES persona ( id_persona );

ALTER TABLE usuario
    ADD CONSTRAINT usuario_rol_fk FOREIGN KEY ( rol_usuario )
        REFERENCES rol( id_rol ); 

ALTER TABLE alumno
    ADD CONSTRAINT alumno_apoderado_fk FOREIGN KEY ( apoderado_id )
        REFERENCES apoderado ( id_apoderado );

ALTER TABLE alumno
    ADD CONSTRAINT alumno_curso_fk FOREIGN KEY ( curso_id )
        REFERENCES curso ( id_curso );

ALTER TABLE alumnopie
    ADD CONSTRAINT alumnopie_alumno_fk FOREIGN KEY ( alumno_id )
        REFERENCES alumno ( id_alumno );

 ALTER TABLE alumnopie
    ADD CONSTRAINT alumnopie_usuario_fk FOREIGN KEY ( usuario_id)
        REFERENCES usuario ( id_usuario );

 ALTER TABLE alumnopie
    ADD CONSTRAINT alumnopie_evaluacion_fk FOREIGN KEY ( evaluacion_id )
        REFERENCES evaluacion ( id_diagnostico );
 
